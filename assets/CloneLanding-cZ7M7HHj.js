import{cc as ce,f4 as le,c9 as de,lb as ae,s as B,T as y,cg as A,cA as Y,cC as ue,d3 as ge,J as pe,ba as fe,aW as Z,j as s,aa as q,f as me,ad as ee,eM as O,bC as H,$ as he,a1 as J,ag as Se,r as x,_ as W,b as ke,u as xe,O as ye,e as be,N as je,c as Le,h as Ce,ak as De,Q as Ie,G as z,B as V,cb as ve,bq as _e,lc as Te,ld as Ee,dE as Pe}from"./index-cVx9Zqte.js";import{p as Ae,K as Q}from"./immer.esm--MpJ8fpr.js";import{_ as Be}from"./_contains-cAWwaXdv.js";import{u as Ne,a as we}from"./uniq-ZuGeDKAp.js";import{S as K}from"./SafeTabPanel-mYwDHsH9.js";import{T as Re}from"./TabLinkList-d9SkE5Nv.js";import{a as Me,T as Oe}from"./TabList-Vcpmm6u6.js";import{u as ze}from"./configs-neuBJQ0E.js";import{u as Qe}from"./disks-JZFpnfFj.js";import{M as $e,N as qe}from"./Notifications-wzV784zW.js";import{L as We}from"./LinodeSelect-MycnhSc0.js";import{a as Fe}from"./append-uKA8oBpu.js";import{p as Ge}from"./pickBy-Q_SibDEG.js";import{L as $}from"./ListItem-HwDJ8kDZ.js";var He=ce(function(i){return le(i.length,function(o,n){var r=Array.prototype.slice.call(arguments,0);return r[0]=n,r[1]=o,i.apply(this,r)})}),Je=de(function(i,o){var n,r;return i.length>o.length?(n=i,r=o):(n=o,r=i),Ne(ae(He(Be)(n),r))});const U=B("button",{label:"StyledButton"})(({theme:e})=>({"& path":{fill:e.palette.primary.main},alignItems:"center",backgroundColor:e.color.white,border:"none",cursor:"pointer",display:"flex",paddingBottom:0,paddingTop:0})),Ve=B(y,{label:"StyledTypography"})(({theme:e})=>({"& a":{color:e.color.red,textDecoration:"underline"},color:e.color.red,marginTop:e.spacing(1)})),Ke=B("header",{label:"StyledHeader"})(({theme:e})=>({display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:e.spacing(2)})),Ue=B("div",{label:"StyledDiv"})({alignItems:"center",display:"flex",justifyContent:"space-between",width:"100%"}),Xe=(e,i)=>{switch(i.type){case"toggleConfig":if(!e.configSelection[i.id])break;const o=e.configSelection[i.id].isSelected;e.configSelection[i.id].isSelected=!o,e.errors=void 0;break;case"toggleDisk":if(!e.diskSelection[i.id])break;const n=e.diskSelection[i.id].isSelected;e.diskSelection[i.id].isSelected=!n,e.errors=void 0;break;case"setSelectedLinodeId":e.selectedLinodeId=i.id,e.errors=void 0;break;case"setSubmitting":e.isSubmitting=i.value;break;case"setErrors":e.errors=i.errors;break;case"clearAll":e.configSelection=A(u=>({...u,isSelected:!1}),e.configSelection),e.diskSelection=A(u=>({...u,isSelected:!1}),e.diskSelection),e.selectedLinodeId=null,e.errors=void 0;break;case"syncConfigsDisks":const{configs:r,disks:a}=i,l=X(e.configSelection),p=X(e.diskSelection),{configSelection:m,diskSelection:h}=es(r,a,l,p);e.configSelection=m,e.diskSelection=h;break}},Ye=Ae(Xe),Ze={configSelection:{},diskSelection:{},isSubmitting:!1,selectedLinodeId:null},X=e=>Y(A(i=>Number(i)),ue,Ge(i=>i.isSelected))(e),es=(e,i,o=[],n=[])=>{const r={},a={},l={};return e.forEach(p=>{const m=o.includes(p.id),u=se(p,i).map(g=>g.id);u.forEach(g=>{l[g]||(l[g]=[]),l[g].push(p.id)}),r[p.id]={associatedDiskIds:u,isSelected:m}}),i.forEach(p=>{const m=n.includes(p.id),h=l[p.id]||[];a[p.id]={associatedConfigIds:h,isSelected:m}}),{configSelection:r,diskSelection:a}},se=(e,i)=>{const o=[];return Object.keys(e.devices).forEach(n=>{e.devices[n]&&e.devices[n].disk_id&&o.push(e.devices[n].disk_id)}),i.filter(n=>o.includes(n.id))},ss=(e,i)=>e.map(o=>{const n=se(o,i);return{...o,associatedDisks:n}}),ts=(e,i)=>Y(we(o=>o.id),ge,Fe(i),A(o=>o.associatedDisks))(e),is=(e,i)=>{const n=Math.ceil((i==="sameDatacenter"?.75:10)*e/1024),r=pe.utc();let l=r.plus({minutes:n,seconds:n>0?1:0}).toRelative(r.toObject());const p="in ";return l!=null&&l.startsWith(p)&&(l=l==null?void 0:l.substring(p.length)),l},ns=e=>{const{clearAll:i,currentLinodeId:o,errorMap:n,handleCancel:r,handleClone:a,handleSelectLinode:l,handleToggleConfig:p,handleToggleDisk:m,isSubmitting:h,selectedConfigs:u,selectedDisks:g,selectedLinodeId:S,selectedLinodeRegion:N,thisLinodeRegion:C}=e,{data:d}=fe(),f=d==null?void 0:d.find(c=>c.id===C),D=Z(),b=n.none,j=n.disk_size,I=!!(b&&b.match(/free space/));let k=I?b:j;k&&!k.endsWith(".")&&(k+=".");const E={resize:`/linodes/${S}/resize`,shrink:`/linodes/${S}/advanced`},L=u.length>0||g.length>1,v=u.length===0&&g.length===0||!S||L&&S===o,P=ts(u,g).reduce((c,T)=>c+T.size,0),_=is(P,C===N?"sameDatacenter":"differentDatacenter");return s.jsxs(q,{"data-testid":"config-clone-selection-details",sx:{padding:D.spacing(2)},children:[s.jsxs(Ke,{children:[s.jsx(y,{variant:"h2",children:"Selected"}),s.jsx(me,{buttonType:"secondary",compactX:!0,onClick:i,sx:{top:`-${D.spacing(.5)}`},children:"Clear"})]}),b&&!I&&s.jsx(ee,{text:b,variant:"error"}),s.jsx(O,{children:u.map(c=>s.jsxs($,{dense:!0,disableGutters:!0,sx:{flexWrap:"wrap",justifyContent:"space-between"},children:[s.jsxs(Ue,{children:[s.jsx(y,{variant:"h3",children:c.label}),s.jsx(U,{"data-qa-inline-delete":!0,onClick:()=>p(c.id),children:s.jsx(H,{})})]}),s.jsx(O,{sx:{flexBasis:"100%",marginLeft:D.spacing(2)},children:c.associatedDisks.map(T=>s.jsx($,{dense:!0,disableGutters:!0,children:s.jsx(y,{children:T.label})},T.label))})]},c.id))}),s.jsx(O,{children:g.map(c=>s.jsxs($,{dense:!0,disableGutters:!0,sx:{flexWrap:"wrap",justifyContent:"space-between"},children:[s.jsx(y,{variant:"h3",children:c.label}),s.jsx(U,{"data-qa-inline-delete":!0,onClick:()=>m(c.id),children:s.jsx(H,{})})]},c.id))}),(u.length>0||g.length>0)&&s.jsx(he,{spacingBottom:16,spacingTop:16}),s.jsxs(y,{"data-testid":`current-datacenter-${f==null?void 0:f.id}`,children:["Current Data Center: ",(f==null?void 0:f.label)??C]}),!v&&s.jsxs(y,{children:["Estimated time: ",_]}),s.jsx(We,{onSelectionChange:c=>{c!==null&&l(c.id)},optionsFilter:L?c=>c.id!==o:void 0,clearable:!1,errorText:k,placeholder:"Destination",value:S}),k&&s.jsxs(Ve,{variant:"body1",children:[k," ",s.jsx(J,{to:E.shrink,children:"Shrink your existing disks"})," ","or"," ",s.jsx(J,{to:E.resize,children:"resize your Linode to a larger plan."})]}),s.jsx(Se,{primaryButtonProps:{disabled:v,label:"Clone",loading:h,onClick:a},secondaryButtonProps:{label:"Cancel",onClick:r}})]})},os=x.lazy(()=>W(()=>import("./Configs-zxH5WHBi.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),rs=x.lazy(()=>W(()=>import("./Disks-d8Xd2lI1.js"),__vite__mapDeps([7,1,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53]))),cs=x.lazy(()=>W(()=>import("./LinodeDetailHeader-sfzb8aj7.js"),__vite__mapDeps([54,1,2,55,56,57,58,9,40,59,60,13,61,45,46,5,6,62,63,29,64,65,66,8,67,68,69,70,71,72,25,73,74,75,76,77,42,78,27,32,22,33,26,34,28,35,36,37,4,23,24,43,79,80,16,81,82,83,84,85,18,19,20,21,3,30,31,38,39,41,44,86,87,88,89,90,91,92,93,94,95,96,97,15,98,99,100,101,102,11,10,103,104,105,106,107,108,109,110,111,112,113,114,115,116,17,47,48,49,50]))),ls=()=>{const{linodeId:e}=ke(),i=xe(),o=ye(),n=be(),r=Z(),a=Number(e),{data:l}=ze(a),{data:p}=Qe(a),{data:m}=je(),{data:h}=Le(a),u=l??[],g=p??[],S=[{routeName:`${o.url}/configs`,title:"Configuration Profiles"},{routeName:`${o.url}/disks`,title:"Disks"}],N=t=>!!_e(t,{path:n.pathname}),C=t=>{i.push(S[t].routeName)},[d,f]=x.useReducer(Ye,Ze),D=JSON.stringify(u.map(t=>t.id)),b=JSON.stringify(g.map(t=>t.id));x.useEffect(()=>{f({configs:u,disks:g,type:"syncConfigsDisks"})},[D,b]);const j=x.useMemo(()=>Ce(n.search),[n.search]);x.useEffect(()=>{const t=Number(j.selectedConfig);if(t&&u)return f({id:t,type:"toggleConfig"})},[j,u]),x.useEffect(()=>{const t=Number(j.selectedDisk);if(t&&g)return f({id:t,type:"toggleDisk"})},[j,g]);const I=t=>f({id:t,type:"toggleConfig"}),k=t=>f({id:t,type:"toggleDisk"}),E=t=>f({id:t,type:"setSelectedLinodeId"}),L=t=>f({type:"setSubmitting",value:t}),v=t=>f({errors:t,type:"setErrors"}),F=()=>f({type:"clearAll"}),P=u.filter(t=>d.configSelection.hasOwnProperty(t.id)),w=P.filter(t=>d.configSelection[t.id].isSelected),_=w.map(t=>t.id),c=g.filter(t=>d.diskSelection.hasOwnProperty(t.id)),R=c.filter(t=>d.diskSelection[t.id].isSelected).map(t=>t.id),te=()=>{if(!d.selectedLinodeId)return;let t;if(d.selectedLinodeId===a){if(R.length!==1)return;t=()=>Te(a,R[0])}else{const M=a,re=d.selectedLinodeId;t=()=>Ee(M,{configs:_,disks:R,linode_id:re})}L(!0),v(void 0),t().then(()=>{L(!1),Pe(),i.push(`/linodes/${a}/configurations`)}).catch(M=>{L(!1),v(M)})},ie=()=>{i.push(`/linodes/${a}/configurations`)},ne=De(["disk_size"],Q(d.errors)),G=m==null?void 0:m.find(t=>t.id===d.selectedLinodeId),oe=G&&G.region;return s.jsxs(x.Fragment,{children:[s.jsx(Ie,{segment:"Clone"}),s.jsx($e,{linodeId:a}),s.jsx(qe,{}),s.jsx(cs,{}),s.jsx(q,{sx:{padding:r.spacing(2)},children:s.jsxs(z,{container:!0,justifyContent:"space-between",sx:{marginTop:r.spacing(1)},children:[s.jsx(z,{md:7,xs:12,children:s.jsxs(q,{sx:{padding:0},children:[s.jsx(y,{"aria-level":2,"data-qa-title":!0,role:"heading",sx:{marginBottom:r.spacing(2)},variant:"h2",children:"Clone"}),s.jsxs(Me,{index:Math.max(S.findIndex(t=>N(t.routeName)),0),onChange:C,children:[s.jsx(Re,{tabs:S}),s.jsxs(Oe,{children:[s.jsx(K,{index:0,children:s.jsx(V,{children:s.jsx(os,{configSelection:Q(d.configSelection),configs:P,handleSelect:I})})}),s.jsx(K,{index:1,children:s.jsxs(V,{children:[s.jsx(ee,{spacingTop:16,variant:"info",children:"You can make a copy of a disk to the same or different Linode. We recommend you power off your Linode first, and keep it powered off until the disk has finished being cloned."}),s.jsx("div",{children:s.jsx(rs,{diskSelection:Q(d.diskSelection),disks:c,handleSelect:k,selectedConfigIds:_})})]})})]})]})]})}),s.jsx(z,{md:4,xs:12,children:s.jsx(ns,{selectedConfigs:ss(w,g),selectedDisks:c.filter(t=>d.diskSelection[t.id].isSelected&&Je(ve([],[t.id,"associatedConfigIds"],d.diskSelection),_).length===0),clearAll:F,currentLinodeId:a,errorMap:ne,handleCancel:ie,handleClone:te,handleSelectLinode:E,handleToggleConfig:I,handleToggleDisk:k,isSubmitting:d.isSubmitting,selectedLinodeId:d.selectedLinodeId,selectedLinodeRegion:oe,thisLinodeRegion:(h==null?void 0:h.region)??""})})]})})]})},Ls=Object.freeze(Object.defineProperty({__proto__:null,default:ls},Symbol.toStringTag,{value:"Module"}));export{Ls as C,Je as i};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/Configs-zxH5WHBi.js","assets/index-cVx9Zqte.js","assets/index-RL6WRErT.css","assets/Paginate-_mtRUOjJ.js","assets/PaginationFooter-8MfyrbrN.js","assets/TableRow-WjckZ-OR.js","assets/TableRowEmpty-HXunljlo.js","assets/Disks-d8Xd2lI1.js","assets/TableHead-aAnFvqns.js","assets/immer.esm--MpJ8fpr.js","assets/_contains-cAWwaXdv.js","assets/uniq-ZuGeDKAp.js","assets/SafeTabPanel-mYwDHsH9.js","assets/TabList-Vcpmm6u6.js","assets/TabLinkList-d9SkE5Nv.js","assets/configs-neuBJQ0E.js","assets/disks-JZFpnfFj.js","assets/Notifications-wzV784zW.js","assets/LinodeDisks-zyiLqtd_.js","assets/AddNewLink-EuioEAZT.js","assets/OrderBy-9siuTGWJ.js","assets/splitAt-OlbwoBj3.js","assets/TableRowError-VT_K71YW.js","assets/TableRowLoading-enpzcj9B.js","assets/Skeleton-Ei33_jCb.js","assets/TableSortCell-N7Qxf5YK.js","assets/formik.esm-XrBweJub.js","assets/Autocomplete-vchTD_Ph.js","assets/Drawer-Zv-UzsLT.js","assets/Radio-9QvviwDe.js","assets/RadioGroup-2qEaOjEa.js","assets/formikErrorUtils-k3dWKVdg.js","assets/AccessPanel-c_TKWhs7.js","assets/CreateSSHKeyDrawer-Lk8yKKuD.js","assets/Code-EQsYwaVK.js","assets/formikTrimUtil-tfsUpEEv.js","assets/getAPIErrorFor-tzBGcA7R.js","assets/usePagination-oVzoT3VV.js","assets/ImageSelect-2dUquSHq.js","assets/cond-OExnIwqZ.js","assets/groupBy-0b_eFpMI.js","assets/LinodePermissionsError-pDRXYuC4.js","assets/DateTimeDisplay-Ll7y9Gvy.js","assets/ActionMenu-LQcZWhDC.js","assets/InlineMenuAction-1MvHCfFL.js","assets/TextTooltip-h4BIBq-b.js","assets/ListItem-HwDJ8kDZ.js","assets/MaintenanceBanner-657Gb0vp.js","assets/accountMaintenance-JIiGpdl-.js","assets/isPast-Rtw250ny.js","assets/useDialog-8AOoxx2F.js","assets/LinodeSelect-MycnhSc0.js","assets/append-uKA8oBpu.js","assets/pickBy-Q_SibDEG.js","assets/LinodeDetailHeader-sfzb8aj7.js","assets/LandingHeader--0FiA91-.js","assets/ProductInformationBanner-F-a7gVWs.js","assets/DeleteLinodeDialog-U6jeVfhE.js","assets/LinodeActionMenu-9Oio_i3b.js","assets/PlansPanel-1fa_pWJg.js","assets/TabbedPanel-7MRGLWE6.js","assets/PlanInformation-hdt1MDMd.js","assets/constants-KokzTiEs.js","assets/Currency-UAWCzS7H.js","assets/SelectionCard-z2Lwslro.js","assets/dynamicPricing-n5eCZqTg.js","assets/linodes-orSDvVk7.js","assets/arePropsEqual-WL8SjyyC.js","assets/getSelectedOptionFromGroupedOptions-3OaG4wtm.js","assets/RenderGuard-G_iNJx_w.js","assets/image.helpers-Yu4Zv1TD.js","assets/CommonStackScript.styles-G8qJvONR.js","assets/index-m2Nl9sJq.js","assets/DebouncedSearchTextField-fJN9axDi.js","assets/ResourcesSection-Ho8bmvI2.js","assets/StackScript-i54gdxpR.js","assets/CopyTooltip-nIZAIwkd.js","assets/index-nat4f1EQ.js","assets/ShowMoreExpansion-g4pF4U0E.js","assets/lishUtils-9MoIA_uJ.js","assets/linodes--kIa80QO.js","assets/RegionSelect-bPwNTvP1.js","assets/Flag-3tAA4S-o.js","assets/Flag-_y0A-gKD.css","assets/visuallyHidden-DVicuktI.js","assets/scrollErrorIntoView-6n4Cku1Y.js","assets/backups-brLSog0e.js","assets/DisplayPrice-m9AmNFV_.js","assets/TypeToConfirm-c9PkDm3L.js","assets/validatePassword-xpiSI_1K.js","assets/main-d_A-GefV.js","assets/assocPath-K5W2bQH9.js","assets/firewalls-Dn__vdrP.js","assets/DeviceSelection-0MgasqMa.js","assets/FormControl-r0VmXCL0.js","assets/TagsPanel-k3d7_0ry.js","assets/tags-i_yRfMC6.js","assets/utils-8fGx1pTO.js","assets/PublicIpsUnassignedTooltip-Pn8zzLr7.js","assets/LinodeIPAddresses-KQ8t9CAA.js","assets/vpcs-2oJlMVgq.js","assets/ipaddr-2fi-A9R9.js","assets/remove-2JFCky0p.js","assets/_isFunction-X3ooR5X_.js","assets/over-DG6TlI65.js","assets/set-KzCOjdyF.js","assets/view-z9rjEf5W.js","assets/StatusIcon-d7wUM4gj.js","assets/recentEventForLinode-2kjhD36D.js","assets/IPAddress-4_lmPo4A.js","assets/ShowMore-N_Z6fJvT.js","assets/ipUtils-8Z2b8Iiq.js","assets/RegionIndicator-9Iv07GLg.js","assets/constants-jI3mcPVd.js","assets/TypeToConfirmDialog-OLeT3MiC.js","assets/useEditableLabelState-sViKJWQc.js","assets/EnableBackupsDialog-okbD-wmg.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}